<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>class Net::SSH::Authentication::Agent - net-ssh 6.0.0.beta1</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../../../";
  var index_rel_prefix = "../../../";
</script>

<script src="../../../js/jquery.js"></script>
<script src="../../../js/darkfish.js"></script>

<link href="../../../css/fonts.css" rel="stylesheet">
<link href="../../../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="class">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../../table_of_contents.html#pages">Pages</a>
    <a href="../../../table_of_contents.html#classes">Classes</a>
    <a href="../../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    <div id="parent-class-section" class="nav-section">
  <h3>Parent</h3>

  
  <p class="link">Object
  
</div>

    <div id="includes-section" class="nav-section">
  <h3>Included Modules</h3>

  <ul class="link-list">
  
  
    <li><a class="include" href="../Loggable.html">Net::SSH::Loggable</a>
  
  
  </ul>
</div>

    <div id="extends-section" class="nav-section">
  <h3>Extended With Modules</h3>

  <ul class="link-list">
    
  
    <li><a class="extend" href="Agent/Comment.html">Net::SSH::Authentication::Agent::Comment</a>
  
  
  </ul>
</div>

    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-c-connect">::connect</a>
    
    <li ><a href="#method-c-new">::new</a>
    
    <li ><a href="#method-i-add_identity">#add_identity</a>
    
    <li ><a href="#method-i-close">#close</a>
    
    <li ><a href="#method-i-connect-21">#connect!</a>
    
    <li ><a href="#method-i-identities">#identities</a>
    
    <li ><a href="#method-i-negotiate-21">#negotiate!</a>
    
    <li ><a href="#method-i-remove_all_identities">#remove_all_identities</a>
    
    <li ><a href="#method-i-remove_identity">#remove_identity</a>
    
    <li ><a href="#method-i-sign">#sign</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="class-Net::SSH::Authentication::Agent">
  <h1 id="class-Net::SSH::Authentication::Agent" class="class">
    class Net::SSH::Authentication::Agent
  </h1>

  <section class="description">
    
<p>This class implements a simple client for the ssh-agent protocol. It does
not implement any specific protocol, but instead copies the behavior of the
ssh-agent functions in the OpenSSH library (3.8).</p>

<p>This means that although it behaves like a SSH1 client, it also has some
SSH2 functionality (like signing data).</p>

  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    
    <section class="constants-list">
      <header>
        <h3>Constants</h3>
      </header>
      <dl>
      
        <dt id="SSH2_AGENT_ADD_IDENTITY">SSH2_AGENT_ADD_IDENTITY
        
        <dd>
        
      
        <dt id="SSH2_AGENT_ADD_ID_CONSTRAINED">SSH2_AGENT_ADD_ID_CONSTRAINED
        
        <dd>
        
      
        <dt id="SSH2_AGENT_FAILURE">SSH2_AGENT_FAILURE
        
        <dd>
        
      
        <dt id="SSH2_AGENT_IDENTITIES_ANSWER">SSH2_AGENT_IDENTITIES_ANSWER
        
        <dd>
        
      
        <dt id="SSH2_AGENT_REMOVE_ALL_IDENTITIES">SSH2_AGENT_REMOVE_ALL_IDENTITIES
        
        <dd>
        
      
        <dt id="SSH2_AGENT_REMOVE_IDENTITY">SSH2_AGENT_REMOVE_IDENTITY
        
        <dd>
        
      
        <dt id="SSH2_AGENT_REQUEST_IDENTITIES">SSH2_AGENT_REQUEST_IDENTITIES
        
        <dd>
        
      
        <dt id="SSH2_AGENT_REQUEST_VERSION">SSH2_AGENT_REQUEST_VERSION
        
        <dd>
        
      
        <dt id="SSH2_AGENT_SIGN_REQUEST">SSH2_AGENT_SIGN_REQUEST
        
        <dd>
        
      
        <dt id="SSH2_AGENT_SIGN_RESPONSE">SSH2_AGENT_SIGN_RESPONSE
        
        <dd>
        
      
        <dt id="SSH2_AGENT_VERSION_RESPONSE">SSH2_AGENT_VERSION_RESPONSE
        
        <dd>
        
      
        <dt id="SSH_AGENT_CONSTRAIN_CONFIRM">SSH_AGENT_CONSTRAIN_CONFIRM
        
        <dd>
        
      
        <dt id="SSH_AGENT_CONSTRAIN_LIFETIME">SSH_AGENT_CONSTRAIN_LIFETIME
        
        <dd>
        
      
        <dt id="SSH_AGENT_FAILURE">SSH_AGENT_FAILURE
        
        <dd>
        
      
        <dt id="SSH_AGENT_REQUEST_RSA_IDENTITIES">SSH_AGENT_REQUEST_RSA_IDENTITIES
        
        <dd>
        
      
        <dt id="SSH_AGENT_RSA_IDENTITIES_ANSWER1">SSH_AGENT_RSA_IDENTITIES_ANSWER1
        
        <dd>
        
      
        <dt id="SSH_AGENT_RSA_IDENTITIES_ANSWER2">SSH_AGENT_RSA_IDENTITIES_ANSWER2
        
        <dd>
        
      
        <dt id="SSH_AGENT_RSA_SHA2_256">SSH_AGENT_RSA_SHA2_256
        
        <dd>
        
      
        <dt id="SSH_AGENT_RSA_SHA2_512">SSH_AGENT_RSA_SHA2_512
        
        <dd>
        
      
        <dt id="SSH_AGENT_SUCCESS">SSH_AGENT_SUCCESS
        
        <dd>
        
      
        <dt id="SSH_COM_AGENT2_FAILURE">SSH_COM_AGENT2_FAILURE
        
        <dd>
        
      
      </dl>
    </section>
    

    
    <section class="attribute-method-details" class="method-section">
      <header>
        <h3>Attributes</h3>
      </header>

      
      <div id="attribute-i-socket" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">socket</span><span
            class="attribute-access-type">[R]</span>
        </div>

        <div class="method-description">
        
        <p>The underlying socket being used to communicate with the <a
href="../../SSH.html">SSH</a> agent.</p>
        
        </div>
      </div>
      
    </section>
    

    
     <section id="public-class-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Class Methods</h3>
       </header>

    
      <div id="method-c-connect" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">connect</span><span
            class="method-args">(logger=nil, agent_socket_factory = nil, identity_agent = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Instantiates a new agent object, connects to a running <a
href="../../SSH.html">SSH</a> agent, negotiates the agent protocol version,
and returns the agent object.</p>
          
          

          
          <div class="method-source-code" id="connect-source">
            <pre><span class="ruby-comment"># File lib/net/ssh/authentication/agent.rb, line 65</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">connect</span>(<span class="ruby-identifier">logger</span>=<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">agent_socket_factory</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">identity_agent</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">agent</span> = <span class="ruby-identifier">new</span>(<span class="ruby-identifier">logger</span>)
  <span class="ruby-identifier">agent</span>.<span class="ruby-identifier">connect!</span>(<span class="ruby-identifier">agent_socket_factory</span>, <span class="ruby-identifier">identity_agent</span>)
  <span class="ruby-identifier">agent</span>.<span class="ruby-identifier">negotiate!</span>
  <span class="ruby-identifier">agent</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-c-new" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">new</span><span
            class="method-args">(logger=nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Creates a new <a href="Agent.html">Agent</a> object, using the optional
logger instance to report status.</p>
          
          

          
          <div class="method-source-code" id="new-source">
            <pre><span class="ruby-comment"># File lib/net/ssh/authentication/agent.rb, line 74</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">logger</span>=<span class="ruby-keyword">nil</span>)
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">logger</span> = <span class="ruby-identifier">logger</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-add_identity" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add_identity</span><span
            class="method-args">(priv_key, comment, lifetime: nil, confirm: false)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Adds the private key with comment to the agent. If lifetime is given, the
key will automatically be removed after lifetime seconds. If confirm is
true, confirmation will be required for each agent signing operation.</p>
          
          

          
          <div class="method-source-code" id="add_identity-source">
            <pre><span class="ruby-comment"># File lib/net/ssh/authentication/agent.rb, line 166</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">add_identity</span>(<span class="ruby-identifier">priv_key</span>, <span class="ruby-identifier">comment</span>, <span class="ruby-identifier">lifetime</span><span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">confirm</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>)
  <span class="ruby-identifier">constraints</span> = <span class="ruby-constant">Buffer</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">lifetime</span>
    <span class="ruby-identifier">constraints</span>.<span class="ruby-identifier">write_byte</span>(<span class="ruby-constant">SSH_AGENT_CONSTRAIN_LIFETIME</span>)
    <span class="ruby-identifier">constraints</span>.<span class="ruby-identifier">write_long</span>(<span class="ruby-identifier">lifetime</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">constraints</span>.<span class="ruby-identifier">write_byte</span>(<span class="ruby-constant">SSH_AGENT_CONSTRAIN_CONFIRM</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">confirm</span>

  <span class="ruby-identifier">req_type</span> = <span class="ruby-identifier">constraints</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">?</span> <span class="ruby-constant">SSH2_AGENT_ADD_IDENTITY</span> <span class="ruby-operator">:</span> <span class="ruby-constant">SSH2_AGENT_ADD_ID_CONSTRAINED</span>
  <span class="ruby-identifier">type</span>, = <span class="ruby-identifier">send_and_wait</span>(<span class="ruby-identifier">req_type</span>, <span class="ruby-value">:string</span>, <span class="ruby-identifier">priv_key</span>.<span class="ruby-identifier">ssh_type</span>, <span class="ruby-value">:raw</span>, <span class="ruby-identifier">blob_for_add</span>(<span class="ruby-identifier">priv_key</span>),
              <span class="ruby-value">:string</span>, <span class="ruby-identifier">comment</span>, <span class="ruby-value">:raw</span>, <span class="ruby-identifier">constraints</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">AgentError</span>, <span class="ruby-string">&quot;could not add identity to agent&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">type</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">SSH_AGENT_SUCCESS</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-close" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">close</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Closes this socket. This agent reference is no longer able to query the
agent.</p>
          
          

          
          <div class="method-source-code" id="close-source">
            <pre><span class="ruby-comment"># File lib/net/ssh/authentication/agent.rb, line 146</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">close</span>
  <span class="ruby-ivar">@socket</span>.<span class="ruby-identifier">close</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-connect-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">connect!</span><span
            class="method-args">(agent_socket_factory = nil, identity_agent = nil)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Connect to the agent process using the socket factory and socket name given
by the attribute writers. If the agent on the other end of the socket
reports that it is an SSH2-compatible agent, this will fail (it only
supports the ssh-agent distributed by OpenSSH).</p>
          
          

          
          <div class="method-source-code" id="connect-21-source">
            <pre><span class="ruby-comment"># File lib/net/ssh/authentication/agent.rb, line 82</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">connect!</span>(<span class="ruby-identifier">agent_socket_factory</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">identity_agent</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">debug</span> { <span class="ruby-string">&quot;connecting to ssh-agent&quot;</span> }
  <span class="ruby-ivar">@socket</span> =
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">agent_socket_factory</span>
      <span class="ruby-identifier">agent_socket_factory</span>.<span class="ruby-identifier">call</span>
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">identity_agent</span>
      <span class="ruby-identifier">unix_socket_class</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">identity_agent</span>)
    <span class="ruby-keyword">elsif</span> <span class="ruby-constant">ENV</span>[<span class="ruby-string">&#39;SSH_AUTH_SOCK&#39;</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">unix_socket_class</span>
      <span class="ruby-identifier">unix_socket_class</span>.<span class="ruby-identifier">open</span>(<span class="ruby-constant">ENV</span>[<span class="ruby-string">&#39;SSH_AUTH_SOCK&#39;</span>])
    <span class="ruby-keyword">elsif</span> <span class="ruby-constant">Gem</span>.<span class="ruby-identifier">win_platform?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">RUBY_ENGINE</span> <span class="ruby-operator">!=</span> <span class="ruby-string">&quot;jruby&quot;</span>
      <span class="ruby-constant">Pageant</span><span class="ruby-operator">::</span><span class="ruby-constant">Socket</span>.<span class="ruby-identifier">open</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">raise</span> <span class="ruby-constant">AgentNotAvailable</span>, <span class="ruby-string">&quot;Agent not configured&quot;</span>
    <span class="ruby-keyword">end</span>
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">StandardError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
  <span class="ruby-identifier">error</span> { <span class="ruby-node">&quot;could not connect to ssh-agent: #{e.message}&quot;</span> }
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">AgentNotAvailable</span>, <span class="ruby-identifier">$!</span>.<span class="ruby-identifier">message</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-identities" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">identities</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Return an array of all identities (public keys) known to the agent. Each
key returned is augmented with a <code>comment</code> property which is set
to the comment returned by the agent for that key.</p>
          
          

          
          <div class="method-source-code" id="identities-source">
            <pre><span class="ruby-comment"># File lib/net/ssh/authentication/agent.rb, line 118</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">identities</span>
  <span class="ruby-identifier">type</span>, <span class="ruby-identifier">body</span> = <span class="ruby-identifier">send_and_wait</span>(<span class="ruby-constant">SSH2_AGENT_REQUEST_IDENTITIES</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">AgentError</span>, <span class="ruby-string">&quot;could not get identity count&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">agent_failed</span>(<span class="ruby-identifier">type</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">AgentError</span>, <span class="ruby-node">&quot;bad authentication reply: #{type}&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">type</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">SSH2_AGENT_IDENTITIES_ANSWER</span>

  <span class="ruby-identifier">identities</span> = []
  <span class="ruby-identifier">body</span>.<span class="ruby-identifier">read_long</span>.<span class="ruby-identifier">times</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">key_str</span> = <span class="ruby-identifier">body</span>.<span class="ruby-identifier">read_string</span>
    <span class="ruby-identifier">comment_str</span> = <span class="ruby-identifier">body</span>.<span class="ruby-identifier">read_string</span>
    <span class="ruby-keyword">begin</span>
      <span class="ruby-identifier">key</span> = <span class="ruby-constant">Buffer</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">key_str</span>).<span class="ruby-identifier">read_key</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">nil?</span>
        <span class="ruby-identifier">error</span> { <span class="ruby-node">&quot;ignoring invalid key: #{comment_str}&quot;</span> }
        <span class="ruby-keyword">next</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">key</span>.<span class="ruby-identifier">extend</span>(<span class="ruby-constant">Comment</span>)
      <span class="ruby-identifier">key</span>.<span class="ruby-identifier">comment</span> = <span class="ruby-identifier">comment_str</span>
      <span class="ruby-identifier">identities</span>.<span class="ruby-identifier">push</span> <span class="ruby-identifier">key</span>
    <span class="ruby-keyword">rescue</span> <span class="ruby-constant">NotImplementedError</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">e</span>
      <span class="ruby-identifier">error</span> { <span class="ruby-node">&quot;ignoring unimplemented key:#{e.message} #{comment_str}&quot;</span> }
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">return</span> <span class="ruby-identifier">identities</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-negotiate-21" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">negotiate!</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Attempts to negotiate the <a href="../../SSH.html">SSH</a> agent protocol
version. Raises an error if the version could not be negotiated
successfully.</p>
          
          

          
          <div class="method-source-code" id="negotiate-21-source">
            <pre><span class="ruby-comment"># File lib/net/ssh/authentication/agent.rb, line 103</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">negotiate!</span>
  <span class="ruby-comment"># determine what type of agent we&#39;re communicating with</span>
  <span class="ruby-identifier">type</span>, <span class="ruby-identifier">body</span> = <span class="ruby-identifier">send_and_wait</span>(<span class="ruby-constant">SSH2_AGENT_REQUEST_VERSION</span>, <span class="ruby-value">:string</span>, <span class="ruby-constant">Transport</span><span class="ruby-operator">::</span><span class="ruby-constant">ServerVersion</span><span class="ruby-operator">::</span><span class="ruby-constant">PROTO_VERSION</span>)

  <span class="ruby-identifier">raise</span> <span class="ruby-constant">AgentNotAvailable</span>, <span class="ruby-string">&quot;SSH2 agents are not yet supported&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">type</span> <span class="ruby-operator">==</span> <span class="ruby-constant">SSH2_AGENT_VERSION_RESPONSE</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">type</span> <span class="ruby-operator">==</span> <span class="ruby-constant">SSH2_AGENT_FAILURE</span>
    <span class="ruby-identifier">debug</span> { <span class="ruby-node">&quot;Unexpected response type==#{type}, this will be ignored&quot;</span> }
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">type</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">SSH_AGENT_RSA_IDENTITIES_ANSWER1</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">type</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">SSH_AGENT_RSA_IDENTITIES_ANSWER2</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">AgentNotAvailable</span>, <span class="ruby-node">&quot;unknown response from agent: #{type}, #{body.to_s.inspect}&quot;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-remove_all_identities" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">remove_all_identities</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Removes all identities from the agent.</p>
          
          

          
          <div class="method-source-code" id="remove_all_identities-source">
            <pre><span class="ruby-comment"># File lib/net/ssh/authentication/agent.rb, line 187</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">remove_all_identities</span>
  <span class="ruby-identifier">type</span>, = <span class="ruby-identifier">send_and_wait</span>(<span class="ruby-constant">SSH2_AGENT_REMOVE_ALL_IDENTITIES</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">AgentError</span>, <span class="ruby-string">&quot;could not remove all identity from agent&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">type</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">SSH_AGENT_SUCCESS</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-remove_identity" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">remove_identity</span><span
            class="method-args">(key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Removes key from the agent.</p>
          
          

          
          <div class="method-source-code" id="remove_identity-source">
            <pre><span class="ruby-comment"># File lib/net/ssh/authentication/agent.rb, line 181</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">remove_identity</span>(<span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">type</span>, = <span class="ruby-identifier">send_and_wait</span>(<span class="ruby-constant">SSH2_AGENT_REMOVE_IDENTITY</span>, <span class="ruby-value">:string</span>, <span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_blob</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">AgentError</span>, <span class="ruby-string">&quot;could not remove identity from agent&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">type</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">SSH_AGENT_SUCCESS</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-sign" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">sign</span><span
            class="method-args">(key, data, flags = 0)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Using the agent and the given public key, sign the given data. The
signature is returned in SSH2 format.</p>
          
          

          
          <div class="method-source-code" id="sign-source">
            <pre><span class="ruby-comment"># File lib/net/ssh/authentication/agent.rb, line 152</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">sign</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">data</span>, <span class="ruby-identifier">flags</span> = <span class="ruby-value">0</span>)
  <span class="ruby-identifier">type</span>, <span class="ruby-identifier">reply</span> = <span class="ruby-identifier">send_and_wait</span>(<span class="ruby-constant">SSH2_AGENT_SIGN_REQUEST</span>, <span class="ruby-value">:string</span>, <span class="ruby-constant">Buffer</span>.<span class="ruby-identifier">from</span>(<span class="ruby-value">:key</span>, <span class="ruby-identifier">key</span>), <span class="ruby-value">:string</span>, <span class="ruby-identifier">data</span>, <span class="ruby-value">:long</span>, <span class="ruby-identifier">flags</span>)

  <span class="ruby-identifier">raise</span> <span class="ruby-constant">AgentError</span>, <span class="ruby-string">&quot;agent could not sign data with requested identity&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">agent_failed</span>(<span class="ruby-identifier">type</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">AgentError</span>, <span class="ruby-node">&quot;bad authentication response #{type}&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">type</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">SSH2_AGENT_SIGN_RESPONSE</span>

  <span class="ruby-keyword">return</span> <span class="ruby-identifier">reply</span>.<span class="ruby-identifier">read_string</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://rdoc.github.io/rdoc">RDoc</a> 5.0.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

